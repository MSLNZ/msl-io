
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Read and write data files">
      
      
      
        <link rel="canonical" href="https://github.com/MSLNZ/msl-io/dev/api/utils/">
      
      
        <link rel="prev" href="../types/">
      
      
        <link rel="next" href="../../readers/">
      
      
      <link rel="icon" href="../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>utils - MSL-IO</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#utils" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MSL-IO" class="md-header__button md-logo" aria-label="MSL-IO" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MSL-IO
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              utils
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-orange"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/MSLNZ/msl-io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
    
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../items/datasets/" class="md-tabs__link">
          
  
  
    
  
  Items

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  API

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../readers/" class="md-tabs__link">
          
  
  
    
  
  Readers

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../writers/" class="md-tabs__link">
          
  
  
    
  
  Writers

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MSL-IO" class="md-nav__button md-logo" aria-label="MSL-IO" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    MSL-IO
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/MSLNZ/msl-io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Overview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Install
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Release Notes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Items
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Items
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../items/datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Datasets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../items/groups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Groups
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../items/metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metadata
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../items/attribute_access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accessing Keys as Class Attributes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    constants
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../freezable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    freezable
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../google/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    google_api
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    metadata
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../node/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    node
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spreadsheets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    spreadsheets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    tables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.GitHead" class="md-nav__link">
    <span class="md-ellipsis">
      GitHead
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.checksum" class="md-nav__link">
    <span class="md-ellipsis">
      checksum
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.copy" class="md-nav__link">
    <span class="md-ellipsis">
      copy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.get_basename" class="md-nav__link">
    <span class="md-ellipsis">
      get_basename
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.git_head" class="md-nav__link">
    <span class="md-ellipsis">
      git_head
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.is_admin" class="md-nav__link">
    <span class="md-ellipsis">
      is_admin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.is_dir_accessible" class="md-nav__link">
    <span class="md-ellipsis">
      is_dir_accessible
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.is_file_readable" class="md-nav__link">
    <span class="md-ellipsis">
      is_file_readable
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.remove_write_permissions" class="md-nav__link">
    <span class="md-ellipsis">
      remove_write_permissions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.run_as_admin" class="md-nav__link">
    <span class="md-ellipsis">
      run_as_admin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.search" class="md-nav__link">
    <span class="md-ellipsis">
      search
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.send_email" class="md-nav__link">
    <span class="md-ellipsis">
      send_email
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../readers/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Readers
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Readers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readers/create/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create a New Reader
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../writers/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Writers
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Writers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../writers/create/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create a New Writer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.GitHead" class="md-nav__link">
    <span class="md-ellipsis">
      GitHead
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.checksum" class="md-nav__link">
    <span class="md-ellipsis">
      checksum
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.copy" class="md-nav__link">
    <span class="md-ellipsis">
      copy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.get_basename" class="md-nav__link">
    <span class="md-ellipsis">
      get_basename
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.git_head" class="md-nav__link">
    <span class="md-ellipsis">
      git_head
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.is_admin" class="md-nav__link">
    <span class="md-ellipsis">
      is_admin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.is_dir_accessible" class="md-nav__link">
    <span class="md-ellipsis">
      is_dir_accessible
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.is_file_readable" class="md-nav__link">
    <span class="md-ellipsis">
      is_file_readable
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.remove_write_permissions" class="md-nav__link">
    <span class="md-ellipsis">
      remove_write_permissions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.run_as_admin" class="md-nav__link">
    <span class="md-ellipsis">
      run_as_admin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.search" class="md-nav__link">
    <span class="md-ellipsis">
      search
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msl.io.utils.send_email" class="md-nav__link">
    <span class="md-ellipsis">
      send_email
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="utils">utils<a class="headerlink" href="#utils" title="Permanent link">造</a></h1>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">

        <p>General functions.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="msl.io.utils.GitHead" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">GitHead</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#msl.io.utils.GitHead" class="headerlink" title="Permanent link">造</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">GitHead</span><span class="p">(</span><span class="nb">hash</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>Information about the <a href="https://git-scm.com/docs/gitglossary#def_HEAD" target="_blank">HEAD</a> of a git repository.</p>
<p>This class is returned from the <a class="autorefs autorefs-internal" title="git_head" href="#msl.io.utils.git_head">git_head</a> function.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="msl.io.utils.checksum" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">checksum</span>


<a href="#msl.io.utils.checksum" class="headerlink" title="Permanent link">造</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">checksum</span><span class="p">(</span>
    <span class="n">file</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;sha256&quot;</span><span class="p">,</span>
    <span class="n">chunk_size</span><span class="o">=</span><span class="mi">65536</span><span class="p">,</span>
    <span class="n">shake_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the checksum of a file.</p>
<p>A checksum is a sequence of numbers and letters that act as a fingerprint
for a file against which later comparisons can be made to detect errors or
changes in the file. It can be used to verify the integrity of the file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PathLike


  
      module-attribute
   (msl.io._types.PathLike)" href="../types/#msl.io._types.PathLike">PathLike</a> | <a class="autorefs autorefs-internal" title="FileLike (msl.io._types.FileLike)" href="../types/#msl.io._types.FileLike">FileLike</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A file to get the checksum of.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>algorithm</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The hash algorithm to use to compute the checksum. See <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/hashlib.html#module-hashlib">hashlib</a> for more details.</p>
              </div>
            </td>
            <td>
                  <code>&#39;sha256&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chunk_size</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of bytes to read at a time from the file. It is useful
to tweak this parameter when reading a large file to improve performance.</p>
              </div>
            </td>
            <td>
                  <code>65536</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shake_length</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The digest length to use for the <code>shake_128</code> or <code>shake_256</code> algorithm.
See <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/hashlib.html#hashlib.shake.hexdigest">hexdigest</a> for more details.</p>
              </div>
            </td>
            <td>
                  <code>256</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The checksum value (which only contains hexadecimal digits).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/msl/io/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">checksum</span><span class="p">(</span>
    <span class="n">file</span><span class="p">:</span> <span class="n">PathLike</span> <span class="o">|</span> <span class="n">FileLike</span><span class="p">[</span><span class="nb">bytes</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;sha256&quot;</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">65536</span><span class="p">,</span> <span class="n">shake_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">256</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the checksum of a file.</span>

<span class="sd">    A checksum is a sequence of numbers and letters that act as a fingerprint</span>
<span class="sd">    for a file against which later comparisons can be made to detect errors or</span>
<span class="sd">    changes in the file. It can be used to verify the integrity of the file.</span>

<span class="sd">    Args:</span>
<span class="sd">        file: A file to get the checksum of.</span>
<span class="sd">        algorithm: The hash algorithm to use to compute the checksum. See [hashlib][] for more details.</span>
<span class="sd">        chunk_size: The number of bytes to read at a time from the file. It is useful</span>
<span class="sd">            to tweak this parameter when reading a large file to improve performance.</span>
<span class="sd">        shake_length: The digest length to use for the `shake_128` or `shake_256` algorithm.</span>
<span class="sd">            See [hexdigest][hashlib.shake.hexdigest] for more details.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The checksum value (which only contains hexadecimal digits).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>  <span class="c1"># noqa: PLC0415</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_read</span><span class="p">(</span><span class="n">fp</span><span class="p">:</span> <span class="n">FileLike</span><span class="p">[</span><span class="nb">bytes</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># read in chucks to avoid loading the entire file at once</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">chunk_size</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">_hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">algorithm</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">)):</span>
        <span class="k">with</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">fsdecode</span><span class="p">(</span><span class="n">file</span><span class="p">))</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">_read</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">position</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
        <span class="n">_read</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_hash</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_hash</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(</span><span class="n">shake_length</span><span class="p">)</span>  <span class="c1"># type: ignore[call-arg]  # pyright: ignore[reportCallIssue,reportUnknownVariableType]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msl.io.utils.copy" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">copy</span>


<a href="#msl.io.utils.copy" class="headerlink" title="Permanent link">造</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">copy</span><span class="p">(</span>
    <span class="n">source</span><span class="p">,</span>
    <span class="n">destination</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">include_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">follow_symlinks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Copy a file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PathLike


  
      module-attribute
   (msl.io._types.PathLike)" href="../types/#msl.io._types.PathLike">PathLike</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to a file to copy.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>destination</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PathLike


  
      module-attribute
   (msl.io._types.PathLike)" href="../types/#msl.io._types.PathLike">PathLike</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A directory to copy the file to or a full path (i.e., includes the basename).
If the directory does not exist then it, and all intermediate directories, will be created.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to overwrite the <code>destination</code> file if it already exists. If <code>destination</code>
already exists and <code>overwrite</code> is <code>False</code> then a <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#FileExistsError">FileExistsError</a> is raised.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_metadata</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to also copy information such as the file permissions,
the latest access time and latest modification time with the file.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>follow_symlinks</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to follow symbolic links.</p>
<div class="admonition note">
<p class="admonition-title">Added in version 0.2</p>
</div>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to where the file was copied.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/msl/io/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span>
    <span class="n">source</span><span class="p">:</span> <span class="n">PathLike</span><span class="p">,</span>
    <span class="n">destination</span><span class="p">:</span> <span class="n">PathLike</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">include_metadata</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">follow_symlinks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Copy a file.</span>

<span class="sd">    Args:</span>
<span class="sd">        source: The path to a file to copy.</span>
<span class="sd">        destination: A directory to copy the file to or a full path (i.e., includes the basename).</span>
<span class="sd">            If the directory does not exist then it, and all intermediate directories, will be created.</span>
<span class="sd">        overwrite: Whether to overwrite the `destination` file if it already exists. If `destination`</span>
<span class="sd">            already exists and `overwrite` is `False` then a [FileExistsError][] is raised.</span>
<span class="sd">        include_metadata: Whether to also copy information such as the file permissions,</span>
<span class="sd">            the latest access time and latest modification time with the file.</span>
<span class="sd">        follow_symlinks: Whether to follow symbolic links.</span>
<span class="sd">            !!! note &quot;Added in version 0.2&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        The path to where the file was copied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>  <span class="c1"># noqa: PLC0415</span>

    <span class="n">src</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">fsdecode</span><span class="p">(</span><span class="n">source</span><span class="p">))</span>
    <span class="n">dst</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">fsdecode</span><span class="p">(</span><span class="n">destination</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">dst</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
        <span class="n">dst</span> <span class="o">=</span> <span class="n">dst</span> <span class="o">/</span> <span class="n">src</span><span class="o">.</span><span class="n">name</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dst</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">overwrite</span> <span class="ow">and</span> <span class="n">dst</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Will not overwrite </span><span class="si">{</span><span class="n">destination</span><span class="si">!r}</span><span class="s2">&quot;</span>
        <span class="k">raise</span> <span class="ne">FileExistsError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">_</span> <span class="o">=</span> <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">follow_symlinks</span><span class="o">=</span><span class="n">follow_symlinks</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">include_metadata</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copystat</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">follow_symlinks</span><span class="o">=</span><span class="n">follow_symlinks</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dst</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msl.io.utils.get_basename" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_basename</span>


<a href="#msl.io.utils.get_basename" class="headerlink" title="Permanent link">造</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_basename</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the basename (the final path component) of a file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PathLike


  
      module-attribute
   (msl.io._types.PathLike)" href="../types/#msl.io._types.PathLike">PathLike</a> | <a class="autorefs autorefs-external" title="typing.IO" href="https://docs.python.org/3/library/typing.html#typing.IO">IO</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | <a class="autorefs autorefs-external" title="typing.IO" href="https://docs.python.org/3/library/typing.html#typing.IO">IO</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The object to get the basename of. If <code>obj</code> is an in-memory file-like
object then the class <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#definition.__name__"><strong>name</strong></a> of <code>obj</code> is returned.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The basename of <code>obj</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/msl/io/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_basename</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">PathLike</span> <span class="o">|</span> <span class="n">IO</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">IO</span><span class="p">[</span><span class="nb">bytes</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the basename (the final path component) of a file.</span>

<span class="sd">    Args:</span>
<span class="sd">        obj: The object to get the basename of. If `obj` is an in-memory file-like</span>
<span class="sd">            object then the class [__name__][definition.__name__] of `obj` is returned.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The basename of `obj`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">fsdecode</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span><span class="o">.</span><span class="n">name</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msl.io.utils.git_head" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">git_head</span>


<a href="#msl.io.utils.git_head" class="headerlink" title="Permanent link">造</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">git_head</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get information about the <a href="https://git-scm.com/docs/gitglossary#def_HEAD" target="_blank">HEAD</a> of a repository.</p>
<p>This function requires that <a href="https://git-scm.com/" target="_blank">git</a> is installed and
that it is available on the <code>PATH</code> environment variable.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PathLike


  
      module-attribute
   (msl.io._types.PathLike)" href="../types/#msl.io._types.PathLike">PathLike</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A directory that is under version control.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="GitHead


  
      dataclass
   (msl.io.utils.GitHead)" href="#msl.io.utils.GitHead">GitHead</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Information about the most recent commit on the current branch.
If <code>directory</code> is not a directory that is under version control
then returns <code>None</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/msl/io/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">git_head</span><span class="p">(</span><span class="n">directory</span><span class="p">:</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GitHead</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get information about the [HEAD]{:target=&quot;_blank&quot;} of a repository.</span>

<span class="sd">    This function requires that [git](https://git-scm.com/){:target=&quot;_blank&quot;} is installed and</span>
<span class="sd">    that it is available on the `PATH` environment variable.</span>

<span class="sd">    [HEAD]: https://git-scm.com/docs/gitglossary#def_HEAD</span>

<span class="sd">    Args:</span>
<span class="sd">        directory: A directory that is under version control.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Information about the most recent commit on the current branch.</span>
<span class="sd">            If `directory` is not a directory that is under version control</span>
<span class="sd">            then returns `None`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;git&quot;</span><span class="p">,</span> <span class="s2">&quot;show&quot;</span><span class="p">,</span> <span class="s2">&quot;-s&quot;</span><span class="p">,</span> <span class="s2">&quot;--format=%H </span><span class="si">%c</span><span class="s2">t&quot;</span><span class="p">,</span> <span class="s2">&quot;HEAD&quot;</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="n">directory</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>  <span class="c1"># noqa: S603</span>
    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">sha</span><span class="p">,</span> <span class="n">timestamp</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">GitHead</span><span class="p">(</span><span class="nb">hash</span><span class="o">=</span><span class="n">sha</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">),</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)))</span>  <span class="c1"># noqa: DTZ006</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msl.io.utils.is_admin" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_admin</span>


<a href="#msl.io.utils.is_admin" class="headerlink" title="Permanent link">造</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_admin</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if the current process is being run as an administrator.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if the current process is being run as an administrator, otherwise <code>False</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/msl/io/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_admin</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the current process is being run as an administrator.</span>

<span class="sd">    Returns:</span>
<span class="sd">        `True` if the current process is being run as an administrator, otherwise `False`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">ctypes</span>  <span class="c1"># noqa: PLC0415</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">is_admin</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">shell32</span><span class="o">.</span><span class="n">IsUserAnAdmin</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">!=</span> <span class="s2">&quot;win32&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">geteuid</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">is_admin</span> <span class="o">==</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msl.io.utils.is_dir_accessible" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_dir_accessible</span>


<a href="#msl.io.utils.is_dir_accessible" class="headerlink" title="Permanent link">造</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_dir_accessible</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if a directory exists and is accessible.</p>
<p>An accessible directory is one that the user has permission to access.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PathLike


  
      module-attribute
   (msl.io._types.PathLike)" href="../types/#msl.io._types.PathLike">PathLike</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory to check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strict</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to raise an exception if the directory is not accessible.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the directory exists and is accessible.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/msl/io/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_dir_accessible</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">PathLike</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a directory exists and is accessible.</span>

<span class="sd">    An accessible directory is one that the user has permission to access.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: The directory to check.</span>
<span class="sd">        strict: Whether to raise an exception if the directory is not accessible.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether the directory exists and is accessible.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">strict</span><span class="p">:</span>
            <span class="k">raise</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msl.io.utils.is_file_readable" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_file_readable</span>


<a href="#msl.io.utils.is_file_readable" class="headerlink" title="Permanent link">造</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_file_readable</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if a file exists and is readable.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PathLike


  
      module-attribute
   (msl.io._types.PathLike)" href="../types/#msl.io._types.PathLike">PathLike</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file to check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strict</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to raise an exception if the file does not exist or is not readable.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the file exists and is readable.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/msl/io/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_file_readable</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="n">PathLike</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a file exists and is readable.</span>

<span class="sd">    Args:</span>
<span class="sd">        file: The file to check.</span>
<span class="sd">        strict: Whether to raise an exception if the file does not exist or is not readable.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether the file exists and is readable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">fsdecode</span><span class="p">(</span><span class="n">file</span><span class="p">))</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;rb&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">strict</span><span class="p">:</span>
            <span class="k">raise</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msl.io.utils.remove_write_permissions" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">remove_write_permissions</span>


<a href="#msl.io.utils.remove_write_permissions" class="headerlink" title="Permanent link">造</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">remove_write_permissions</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Remove all write permissions of a file.</p>
<p>On Windows, this function will set the file attribute to be read only.</p>
<p>On Linux and macOS, write permission is removed for the User,
Group and Others. The read and execute permissions are preserved.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PathLike


  
      module-attribute
   (msl.io._types.PathLike)" href="../types/#msl.io._types.PathLike">PathLike</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to remove the write permissions of.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/msl/io/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_write_permissions</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">PathLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove all write permissions of a file.</span>

<span class="sd">    On Windows, this function will set the file attribute to be read only.</span>

<span class="sd">    On Linux and macOS, write permission is removed for the User,</span>
<span class="sd">    Group and Others. The read and execute permissions are preserved.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: The path to remove the write permissions of.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">stat</span>  <span class="c1"># noqa: PLC0415</span>

    <span class="n">current_permissions</span> <span class="o">=</span> <span class="n">stat</span><span class="o">.</span><span class="n">S_IMODE</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">lstat</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">st_mode</span><span class="p">)</span>
    <span class="n">disable_writing</span> <span class="o">=</span> <span class="o">~</span><span class="n">stat</span><span class="o">.</span><span class="n">S_IWUSR</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">stat</span><span class="o">.</span><span class="n">S_IWGRP</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">stat</span><span class="o">.</span><span class="n">S_IWOTH</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chmod</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">current_permissions</span> <span class="o">&amp;</span> <span class="n">disable_writing</span><span class="p">)</span>  <span class="c1"># noqa: PTH101</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msl.io.utils.run_as_admin" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">run_as_admin</span>


<a href="#msl.io.utils.run_as_admin" class="headerlink" title="Permanent link">造</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">run_as_admin</span><span class="p">(</span>
    <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">executable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">cwd</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">capture_stderr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Run a process as an administrator and return its output.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PathLike


  
      module-attribute
   (msl.io._types.PathLike)" href="../types/#msl.io._types.PathLike">PathLike</a> | <a class="autorefs autorefs-external" title="collections.abc.Sequence" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a>[<a class="autorefs autorefs-internal" title="PathLike


  
      module-attribute
   (msl.io._types.PathLike)" href="../types/#msl.io._types.PathLike">PathLike</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A sequence of program arguments or else a command string. Providing a sequence of
arguments is generally preferred, as it allows the subprocess to take care of any required
escaping and quoting of arguments (e.g., to permit spaces in file names).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>executable</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PathLike


  
      module-attribute
   (msl.io._types.PathLike)" href="../types/#msl.io._types.PathLike">PathLike</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The executable to pass the <code>args</code> to.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cwd</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PathLike


  
      module-attribute
   (msl.io._types.PathLike)" href="../types/#msl.io._types.PathLike">PathLike</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The working directory to use for the elevated process.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>capture_stderr</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to send the stderr stream to stdout.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>blocking</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to wait for the process to finish before returning to the calling program.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show the elevated console (Windows only). If <code>True</code>, the stdout stream of
the process is not captured.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the current process already has admin privileges or if the operating system is
not Windows then all additional keyword arguments are passed to <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/subprocess.html#subprocess.check_output">subprocess.check_output</a>.
Otherwise, only a <code>timeout</code> keyword argument is used (Windows).</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a> | <a class="autorefs autorefs-external" title="subprocess.Popen" href="https://docs.python.org/3/library/subprocess.html#subprocess.Popen">Popen</a>[<a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The returned object depends on whether the process is executed in blocking or non-blocking mode</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a> | <a class="autorefs autorefs-external" title="subprocess.Popen" href="https://docs.python.org/3/library/subprocess.html#subprocess.Popen">Popen</a>[<a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>and whether Python is already running with admin privileges.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a> | <a class="autorefs autorefs-external" title="subprocess.Popen" href="https://docs.python.org/3/library/subprocess.html#subprocess.Popen">Popen</a>[<a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If blocking, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a> are returned (the stdout stream of the process). If non-blocking, the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a> | <a class="autorefs autorefs-external" title="subprocess.Popen" href="https://docs.python.org/3/library/subprocess.html#subprocess.Popen">Popen</a>[<a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>returned object will either be the <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/subprocess.html#subprocess.Popen">subprocess.Popen</a> instance that is running the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a> | <a class="autorefs autorefs-external" title="subprocess.Popen" href="https://docs.python.org/3/library/subprocess.html#subprocess.Popen">Popen</a>[<a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>process (POSIX) or an <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> which is the process ID (Windows).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/msl/io/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_as_admin</span><span class="p">(</span>  <span class="c1"># noqa: C901, PLR0912, PLR0913, PLR0915</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">PathLike</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">PathLike</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">executable</span><span class="p">:</span> <span class="n">PathLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">cwd</span><span class="p">:</span> <span class="n">PathLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">capture_stderr</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">blocking</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">Popen</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run a process as an administrator and return its output.</span>

<span class="sd">    Args:</span>
<span class="sd">        args: A sequence of program arguments or else a command string. Providing a sequence of</span>
<span class="sd">            arguments is generally preferred, as it allows the subprocess to take care of any required</span>
<span class="sd">            escaping and quoting of arguments (e.g., to permit spaces in file names).</span>
<span class="sd">        executable: The executable to pass the `args` to.</span>
<span class="sd">        cwd: The working directory to use for the elevated process.</span>
<span class="sd">        capture_stderr: Whether to send the stderr stream to stdout.</span>
<span class="sd">        blocking: Whether to wait for the process to finish before returning to the calling program.</span>
<span class="sd">        show: Whether to show the elevated console (Windows only). If `True`, the stdout stream of</span>
<span class="sd">            the process is not captured.</span>
<span class="sd">        kwargs: If the current process already has admin privileges or if the operating system is</span>
<span class="sd">            not Windows then all additional keyword arguments are passed to [subprocess.check_output][].</span>
<span class="sd">            Otherwise, only a `timeout` keyword argument is used (Windows).</span>

<span class="sd">    Returns:</span>
<span class="sd">        The returned object depends on whether the process is executed in blocking or non-blocking mode</span>
<span class="sd">        and whether Python is already running with admin privileges.</span>
<span class="sd">        If blocking, [bytes][] are returned (the stdout stream of the process). If non-blocking, the</span>
<span class="sd">        returned object will either be the [subprocess.Popen][] instance that is running the</span>
<span class="sd">        process (POSIX) or an [int][] which is the process ID (Windows).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">executable</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Must specify the args and/or an executable&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">stderr</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span> <span class="k">if</span> <span class="n">capture_stderr</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span> <span class="k">if</span> <span class="n">blocking</span> <span class="k">else</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span>

    <span class="k">if</span> <span class="n">is_admin</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">executable</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>  <span class="c1"># noqa: S101</span>
            <span class="k">return</span> <span class="n">process</span><span class="p">(</span><span class="n">executable</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="n">cwd</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">stderr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># pyright: ignore[reportUnknownVariableType]</span>
        <span class="k">return</span> <span class="n">process</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">executable</span><span class="o">=</span><span class="n">executable</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="n">cwd</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">stderr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># pyright: ignore[reportUnknownVariableType]</span>

    <span class="n">exe</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">executable</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">list2cmdline</span><span class="p">([</span><span class="n">os</span><span class="o">.</span><span class="n">fsdecode</span><span class="p">(</span><span class="n">executable</span><span class="p">)])</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;nt&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;sudo&quot;</span><span class="p">,</span> <span class="n">exe</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">)):</span>
            <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;sudo&quot;</span><span class="p">,</span> <span class="n">exe</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">fsdecode</span><span class="p">(</span><span class="n">args</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;sudo&quot;</span><span class="p">,</span> <span class="n">exe</span><span class="p">,</span> <span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">fsdecode</span><span class="p">,</span> <span class="n">args</span><span class="p">))]</span>
        <span class="k">return</span> <span class="n">process</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="n">cwd</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">stderr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># pyright: ignore[reportUnknownVariableType]</span>

    <span class="c1"># Windows is more complicated</span>

    <span class="k">if</span> <span class="n">args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">(</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">)):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">fsdecode</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">list2cmdline</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">cwd</span> <span class="k">else</span> <span class="n">os</span><span class="o">.</span><span class="n">fsdecode</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>  <span class="c1"># noqa: PTH109</span>

    <span class="c1"># the &#39;runas&#39; verb starts in C:\WINDOWS\system32</span>
    <span class="n">cd</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">list2cmdline</span><span class="p">([</span><span class="s2">&quot;cd&quot;</span><span class="p">,</span> <span class="s2">&quot;/d&quot;</span><span class="p">,</span> <span class="n">cwd</span><span class="p">,</span> <span class="s2">&quot;&amp;&amp;&quot;</span><span class="p">])</span>

    <span class="c1"># check if a Python environment needs to be activated</span>
    <span class="n">activate</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">exe</span> <span class="o">==</span> <span class="n">sys</span><span class="o">.</span><span class="n">executable</span> <span class="ow">or</span> <span class="n">args</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">):</span>
        <span class="n">conda</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CONDA_PREFIX&quot;</span><span class="p">)</span>  <span class="c1"># conda</span>
        <span class="n">venv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;VIRTUAL_ENV&quot;</span><span class="p">)</span>  <span class="c1"># venv</span>
        <span class="k">if</span> <span class="n">conda</span><span class="p">:</span>
            <span class="n">env</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CONDA_DEFAULT_ENV&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">env</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;CONDA_DEFAULT_ENV environment variable does not exist&quot;</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">env</span> <span class="o">==</span> <span class="s2">&quot;base&quot;</span><span class="p">:</span>
                <span class="n">bat</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">conda</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;Scripts&quot;</span> <span class="o">/</span> <span class="s2">&quot;activate.bat&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bat</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">conda</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;Scripts&quot;</span> <span class="o">/</span> <span class="s2">&quot;activate.bat&quot;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">bat</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Cannot find </span><span class="si">{</span><span class="n">bat</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">activate</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">list2cmdline</span><span class="p">([</span><span class="n">bat</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="s2">&quot;&amp;&amp;&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">venv</span><span class="p">:</span>
            <span class="n">bat</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">venv</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;Scripts&quot;</span> <span class="o">/</span> <span class="s2">&quot;activate.bat&quot;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">bat</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Cannot find </span><span class="si">{</span><span class="n">bat</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">activate</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">list2cmdline</span><span class="p">([</span><span class="n">bat</span><span class="p">,</span> <span class="s2">&quot;&amp;&amp;&quot;</span><span class="p">])</span>

    <span class="c1"># redirect stdout (stderr) to a file</span>
    <span class="n">redirect</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">stdout_file</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">show</span><span class="p">:</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>  <span class="c1"># noqa: PLC0415</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">uuid</span>  <span class="c1"># noqa: PLC0415</span>

        <span class="n">stdout_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">())</span> <span class="o">/</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">stdout_file</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">capture_stderr</span><span class="p">:</span>
            <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;2&gt;&amp;1&quot;</span><span class="p">)</span>
        <span class="n">redirect</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">list2cmdline</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\d$&quot;</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
            <span class="c1"># this number is also considered as a file handle, so add a space</span>
            <span class="n">redirect</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">redirect</span>

    <span class="c1"># the string that is passed to cmd.exe</span>
    <span class="n">params</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/S /C &quot;</span><span class="si">{</span><span class="n">cd</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">activate</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">exe</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s1">&quot;</span><span class="si">{</span><span class="n">redirect</span><span class="si">}</span><span class="s1">&#39;</span>

    <span class="kn">import</span><span class="w"> </span><span class="nn">ctypes</span>  <span class="c1"># noqa: PLC0415</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">ctypes.wintypes</span><span class="w"> </span><span class="kn">import</span> <span class="n">DWORD</span><span class="p">,</span> <span class="n">HANDLE</span><span class="p">,</span> <span class="n">HINSTANCE</span><span class="p">,</span> <span class="n">HKEY</span><span class="p">,</span> <span class="n">HWND</span><span class="p">,</span> <span class="n">INT</span><span class="p">,</span> <span class="n">LPCWSTR</span><span class="p">,</span> <span class="n">ULONG</span>  <span class="c1"># noqa: PLC0415</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">ShellExecuteInfoW</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">Structure</span><span class="p">):</span>
        <span class="n">_fields_</span> <span class="o">=</span> <span class="p">(</span>  <span class="c1"># pyright: ignore[reportUnannotatedClassAttribute]</span>
            <span class="p">(</span><span class="s2">&quot;cbSize&quot;</span><span class="p">,</span> <span class="n">DWORD</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;fMask&quot;</span><span class="p">,</span> <span class="n">ULONG</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;hwnd&quot;</span><span class="p">,</span> <span class="n">HWND</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;lpVerb&quot;</span><span class="p">,</span> <span class="n">LPCWSTR</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;lpFile&quot;</span><span class="p">,</span> <span class="n">LPCWSTR</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;lpParameters&quot;</span><span class="p">,</span> <span class="n">LPCWSTR</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;lpDirectory&quot;</span><span class="p">,</span> <span class="n">LPCWSTR</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;nShow&quot;</span><span class="p">,</span> <span class="n">INT</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;hInstApp&quot;</span><span class="p">,</span> <span class="n">HINSTANCE</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;lpIDList&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;lpClass&quot;</span><span class="p">,</span> <span class="n">LPCWSTR</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;hkeyClass&quot;</span><span class="p">,</span> <span class="n">HKEY</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;dwHotKey&quot;</span><span class="p">,</span> <span class="n">DWORD</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;hIcon&quot;</span><span class="p">,</span> <span class="n">HANDLE</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;hProcess&quot;</span><span class="p">,</span> <span class="n">HANDLE</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="n">sei</span> <span class="o">=</span> <span class="n">ShellExecuteInfoW</span><span class="p">()</span>
    <span class="n">sei</span><span class="o">.</span><span class="n">fMask</span> <span class="o">=</span> <span class="mh">0x00000040</span> <span class="o">|</span> <span class="mh">0x00008000</span>  <span class="c1"># SEE_MASK_NOCLOSEPROCESS | SEE_MASK_NO_CONSOLE</span>
    <span class="n">sei</span><span class="o">.</span><span class="n">lpVerb</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;verb&quot;</span><span class="p">,</span> <span class="s2">&quot;runas&quot;</span><span class="p">)</span>  <span class="c1"># change the verb when running the tests</span>
    <span class="n">sei</span><span class="o">.</span><span class="n">lpFile</span> <span class="o">=</span> <span class="s2">&quot;cmd.exe&quot;</span>
    <span class="n">sei</span><span class="o">.</span><span class="n">lpParameters</span> <span class="o">=</span> <span class="n">params</span>
    <span class="n">sei</span><span class="o">.</span><span class="n">lpDirectory</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cwd</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">cwd</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">sei</span><span class="o">.</span><span class="n">nShow</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">show</span><span class="p">)</span>
    <span class="n">sei</span><span class="o">.</span><span class="n">cbSize</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">sei</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">Shell32</span><span class="o">.</span><span class="n">ShellExecuteExW</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">sei</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">WinError</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">blocking</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="n">sei</span><span class="o">.</span><span class="n">hProcess</span><span class="p">)</span>

    <span class="n">kernel32</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">kernel32</span>
    <span class="n">timeout</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timeout&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># INFINITE = -1</span>
    <span class="n">milliseconds</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timeout</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span> <span class="k">if</span> <span class="n">timeout</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">timeout</span>

    <span class="n">ret</span> <span class="o">=</span> <span class="n">kernel32</span><span class="o">.</span><span class="n">WaitForSingleObject</span><span class="p">(</span><span class="n">sei</span><span class="o">.</span><span class="n">hProcess</span><span class="p">,</span> <span class="n">milliseconds</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># WAIT_OBJECT_0</span>
        <span class="n">stdout</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">stdout_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">stdout_file</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="n">stdout</span> <span class="o">=</span> <span class="n">stdout_file</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>
            <span class="n">stdout_file</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>

        <span class="n">code</span> <span class="o">=</span> <span class="n">DWORD</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">kernel32</span><span class="o">.</span><span class="n">GetExitCodeProcess</span><span class="p">(</span><span class="n">sei</span><span class="o">.</span><span class="n">hProcess</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">code</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">WinError</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">code</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">FormatError</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="n">out_str</span> <span class="o">=</span> <span class="n">stdout</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="s2">&quot;ignore&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Set show=False to capture the stdout stream.&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">capture_stderr</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Set capture_stderr=True to see if more information is available.&quot;</span>
                <span class="k">if</span> <span class="n">out_str</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">out_str</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">raise</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">WinError</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>

        <span class="n">kernel32</span><span class="o">.</span><span class="n">CloseHandle</span><span class="p">(</span><span class="n">sei</span><span class="o">.</span><span class="n">hProcess</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">stdout</span>

    <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="mh">0xFFFFFFFF</span><span class="p">:</span>  <span class="c1"># WAIT_FAILED  # noqa: PLR2004</span>
        <span class="k">raise</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">WinError</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="mh">0x00000080</span><span class="p">:</span>  <span class="c1"># WAIT_ABANDONED  # noqa: PLR2004</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The specified object is a mutex object that was not &quot;</span>
            <span class="s2">&quot;released by the thread that owned the mutex object before &quot;</span>
            <span class="s2">&quot;the owning thread terminated. Ownership of the mutex &quot;</span>
            <span class="s2">&quot;object is granted to the calling thread and the mutex state &quot;</span>
            <span class="s2">&quot;is set to non-signalled. If the mutex was protecting persistent &quot;</span>
            <span class="s2">&quot;state information, you should check it for consistency.&quot;</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">ret</span> <span class="o">==</span> <span class="mh">0x00000102</span><span class="p">:</span>  <span class="c1"># WAIT_TIMEOUT  # noqa: PLR2004</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;The timeout interval elapsed after </span><span class="si">{</span><span class="n">timeout</span><span class="si">}</span><span class="s2"> second(s) and the object&#39;s state is non-signalled.&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Unknown return value 0x</span><span class="si">{</span><span class="n">ret</span><span class="si">:</span><span class="s2">x</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;WaitForSingleObject: </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msl.io.utils.search" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">search</span>


<a href="#msl.io.utils.search" class="headerlink" title="Permanent link">造</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">search</span><span class="p">(</span>
    <span class="n">directory</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">include</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ignore_os_error</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">ignore_hidden_folders</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">follow_symlinks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Search for files starting from a root directory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PathLike


  
      module-attribute
   (msl.io._types.PathLike)" href="../types/#msl.io._types.PathLike">PathLike</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The root directory to begin searching for files.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>depth</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of sub-directories to recursively search for files.
If <code>0</code>, only files in <code>directory</code> are searched, if <code>1</code> then files in <code>directory</code>
and in one sub-directory are searched, etc. If <code>None</code>, search <code>directory</code> and
recursively search all sub-directories.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" title="re.Pattern" href="https://docs.python.org/3/library/re.html#re.Pattern">Pattern</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A regular-expression pattern to use to include files. If <code>None</code>, no filtering
is applied and all files are yielded (that are not <code>exclude</code>d). For example,</p>
<ul>
<li><code>r"data"</code> &#8594; find files with the word <code>data</code> in the file path</li>
<li><code>r"\.png$"</code> &#8594; find files with the extension <code>.png</code></li>
<li><code>r"\.jpe*g$"</code> &#8594; find files with the extension <code>.jpeg</code> or <code>.jpg</code></li>
</ul>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exclude</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" title="re.Pattern" href="https://docs.python.org/3/library/re.html#re.Pattern">Pattern</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A regular-expression pattern to use to exclude files. The <code>exclude</code> pattern
has precedence over the <code>include</code> pattern. For example,</p>
<ul>
<li><code>r"bin"</code> &#8594; exclude all files that contain the word <code>bin</code> in the file path</li>
<li><code>r"bin|lib"</code> &#8594; exclude all files that contain the word <code>bin</code> or <code>lib</code> in the file path</li>
</ul>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>flags</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The flags to use to compile regular-expression pattern (if it is a <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> type).</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ignore_os_error</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to ignore an <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#OSError">OSError</a>, if one occurs, while iterating through a directory.
This type of error can occur if a directory does not have the appropriate read permission.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ignore_hidden_folders</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to ignore a hidden directory from the search. A hidden directory
starts with a <code>.</code> (a dot).</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>follow_symlinks</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to search for files by following symbolic links.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="collections.abc.Generator" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Generator">Generator</a>[<a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to a file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/msl/io/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span>  <span class="c1"># noqa: C901, PLR0913</span>
    <span class="n">directory</span><span class="p">:</span> <span class="n">PathLike</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">Pattern</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">Pattern</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">flags</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">ignore_os_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ignore_hidden_folders</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">follow_symlinks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">Path</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Search for files starting from a root directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        directory: The root directory to begin searching for files.</span>
<span class="sd">        depth: The number of sub-directories to recursively search for files.</span>
<span class="sd">            If `0`, only files in `directory` are searched, if `1` then files in `directory`</span>
<span class="sd">            and in one sub-directory are searched, etc. If `None`, search `directory` and</span>
<span class="sd">            recursively search all sub-directories.</span>
<span class="sd">        include: A regular-expression pattern to use to include files. If `None`, no filtering</span>
<span class="sd">            is applied and all files are yielded (that are not `exclude`d). For example,</span>

<span class="sd">            * `r&quot;data&quot;` &amp;#8594; find files with the word `data` in the file path</span>
<span class="sd">            * `r&quot;\.png$&quot;` &amp;#8594; find files with the extension `.png`</span>
<span class="sd">            * `r&quot;\.jpe*g$&quot;` &amp;#8594; find files with the extension `.jpeg` or `.jpg`</span>

<span class="sd">        exclude: A regular-expression pattern to use to exclude files. The `exclude` pattern</span>
<span class="sd">            has precedence over the `include` pattern. For example,</span>

<span class="sd">            * `r&quot;bin&quot;` &amp;#8594; exclude all files that contain the word `bin` in the file path</span>
<span class="sd">            * `r&quot;bin|lib&quot;` &amp;#8594; exclude all files that contain the word `bin` or `lib` in the file path</span>

<span class="sd">        flags: The flags to use to compile regular-expression pattern (if it is a [str][] type).</span>
<span class="sd">        ignore_os_error: Whether to ignore an [OSError][], if one occurs, while iterating through a directory.</span>
<span class="sd">            This type of error can occur if a directory does not have the appropriate read permission.</span>
<span class="sd">        ignore_hidden_folders: Whether to ignore a hidden directory from the search. A hidden directory</span>
<span class="sd">            starts with a `.` (a dot).</span>
<span class="sd">        follow_symlinks: Whether to search for files by following symbolic links.</span>

<span class="sd">    Yields:</span>
<span class="sd">        The path to a file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">depth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">depth</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">fsdecode</span><span class="p">(</span><span class="n">directory</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">ignore_hidden_folders</span> <span class="ow">and</span> <span class="n">folder</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;search ignored hidden folder &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="n">folder</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exclude</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">exclude</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">exclude</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">include</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">include</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">include</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">os</span><span class="o">.</span><span class="n">scandir</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span> <span class="k">as</span> <span class="n">it</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
                    <span class="n">path</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">path</span>
                    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">and</span> <span class="n">exclude</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;search excluded file </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">include</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">include</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
                        <span class="k">yield</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_dir</span><span class="p">(</span><span class="n">follow_symlinks</span><span class="o">=</span><span class="n">follow_symlinks</span><span class="p">):</span>
                    <span class="k">yield from</span> <span class="n">search</span><span class="p">(</span>
                        <span class="n">entry</span><span class="p">,</span>
                        <span class="n">depth</span><span class="o">=</span><span class="kc">None</span> <span class="k">if</span> <span class="n">depth</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="n">include</span><span class="o">=</span><span class="n">include</span><span class="p">,</span>
                        <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span>
                        <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>
                        <span class="n">ignore_os_error</span><span class="o">=</span><span class="n">ignore_os_error</span><span class="p">,</span>
                        <span class="n">ignore_hidden_folders</span><span class="o">=</span><span class="n">ignore_hidden_folders</span><span class="p">,</span>
                        <span class="n">follow_symlinks</span><span class="o">=</span><span class="n">follow_symlinks</span><span class="p">,</span>
                    <span class="p">)</span>
    <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;search raised OSError for &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="n">folder</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_os_error</span><span class="p">:</span>
            <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="msl.io.utils.send_email" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">send_email</span>


<a href="#msl.io.utils.send_email" class="headerlink" title="Permanent link">造</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">send_email</span><span class="p">(</span>
    <span class="n">config</span><span class="p">,</span> <span class="n">recipients</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subject</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Send an email.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PathLike


  
      module-attribute
   (msl.io._types.PathLike)" href="../types/#msl.io._types.PathLike">PathLike</a> | <a class="autorefs autorefs-internal" title="SupportsRead (msl.io._types.SupportsRead)" href="../types/#msl.io._types.SupportsRead">SupportsRead</a>[<a class="autorefs autorefs-external" title="typing.AnyStr" href="https://docs.python.org/3/library/typing.html#typing.AnyStr">AnyStr</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An INI-style configuration file that contains information on how to send
an email. There are two ways to send an email &mdash; Gmail API or SMTP server.</p>
<p>An example INI file to use the Gmail API is the following (see
<a class="autorefs autorefs-internal" title="GMail" href="../google/#msl.io.google_api.GMail">GMmail</a> for more details). Although all
key-value pairs are optional, a <code>[gmail]</code> section must exist to use
the Gmail API. If a key is omitted, the value passed to
<a class="autorefs autorefs-internal" title="GMail" href="../google/#msl.io.google_api.GMail">GMmail</a> is <code>None</code></p>
<div class="highlight"><pre><span></span><code><span class="k">[gmail]</span>
<span class="na">account</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">work</span>
<span class="na">credentials</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">path/to/client_secrets.json</span>
<span class="na">scopes</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="na">https</span><span class="o">:</span><span class="s">//www.googleapis.com/auth/gmail.send</span>
<span class="w">    </span><span class="na">https</span><span class="o">:</span><span class="s">//www.googleapis.com/auth/gmail.metadata</span>
<span class="na">domain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@gmail.com</span>
</code></pre></div>
<p>An example INI file for an SMTP server is the following. Only the <code>host</code>
and <code>port</code> key-value pairs are required.</p>
<div class="highlight"><pre><span></span><code><span class="k">[smtp]</span>
<span class="na">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">hostname or IP address of the SMTP server</span>
<span class="na">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">port number to connect to on the SMTP server (e.g., 25)</span>
<span class="na">starttls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true|yes|1|on -or- false|no|0|off (default: false)</span>
<span class="na">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">the username to authenticate with (default: None)</span>
<span class="na">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">the password for username (default: None)</span>
<span class="na">domain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@company.com (default: None)</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since this information is specified in plain text in the configuration
file, you should set the file permissions provided by your operating
system to ensure that your authentication credentials are safe.</p>
</div>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>recipients</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/glossary.html#term-list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The email address(es) of the recipient(s). Can omit the <code>@domain.com</code>
part if a <code>domain</code> key is specified in the <code>config</code> file. Can use the value
<code>'me'</code> if sending an email to yourself via Gmail.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sender</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The email address of the sender. Can omit the <code>@domain.com</code> part
if a <code>domain</code> key is specified in the <code>config</code> file. If <code>sender</code> is not
specified, it becomes the value of the first <code>recipient</code> if using SMTP
or the value <code>'me'</code> if using Gmail.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subject</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The text to include in the subject field.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>body</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The text to include in the body of the email. The text can be enclosed
in <code>&lt;html&gt;&lt;/html&gt;</code> tags to use HTML elements to format the message.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/msl/io/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">send_email</span><span class="p">(</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">PathLike</span> <span class="o">|</span> <span class="n">SupportsRead</span><span class="p">[</span><span class="n">AnyStr</span><span class="p">],</span>
    <span class="n">recipients</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">sender</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">subject</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">body</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Send an email.</span>

<span class="sd">    Args:</span>
<span class="sd">        config: An INI-style configuration file that contains information on how to send</span>
<span class="sd">            an email. There are two ways to send an email &amp;mdash; Gmail API or SMTP server.</span>

<span class="sd">            An example INI file to use the Gmail API is the following (see</span>
<span class="sd">            [GMmail][msl.io.google_api.GMail] for more details). Although all</span>
<span class="sd">            key-value pairs are optional, a `[gmail]` section must exist to use</span>
<span class="sd">            the Gmail API. If a key is omitted, the value passed to</span>
<span class="sd">            [GMmail][msl.io.google_api.GMail] is `None`</span>

<span class="sd">            ```ini</span>
<span class="sd">            [gmail]</span>
<span class="sd">            account = work</span>
<span class="sd">            credentials = path/to/client_secrets.json</span>
<span class="sd">            scopes =</span>
<span class="sd">                https://www.googleapis.com/auth/gmail.send</span>
<span class="sd">                https://www.googleapis.com/auth/gmail.metadata</span>
<span class="sd">            domain = @gmail.com</span>
<span class="sd">            ```</span>

<span class="sd">            An example INI file for an SMTP server is the following. Only the `host`</span>
<span class="sd">            and `port` key-value pairs are required.</span>

<span class="sd">            ```ini</span>
<span class="sd">            [smtp]</span>
<span class="sd">            host = hostname or IP address of the SMTP server</span>
<span class="sd">            port = port number to connect to on the SMTP server (e.g., 25)</span>
<span class="sd">            starttls = true|yes|1|on -or- false|no|0|off (default: false)</span>
<span class="sd">            username = the username to authenticate with (default: None)</span>
<span class="sd">            password = the password for username (default: None)</span>
<span class="sd">            domain = @company.com (default: None)</span>
<span class="sd">            ```</span>

<span class="sd">            !!! warning</span>
<span class="sd">                Since this information is specified in plain text in the configuration</span>
<span class="sd">                file, you should set the file permissions provided by your operating</span>
<span class="sd">                system to ensure that your authentication credentials are safe.</span>

<span class="sd">        recipients: The email address(es) of the recipient(s). Can omit the `@domain.com`</span>
<span class="sd">            part if a `domain` key is specified in the `config` file. Can use the value</span>
<span class="sd">            `&#39;me&#39;` if sending an email to yourself via Gmail.</span>
<span class="sd">        sender: The email address of the sender. Can omit the `@domain.com` part</span>
<span class="sd">            if a `domain` key is specified in the `config` file. If `sender` is not</span>
<span class="sd">            specified, it becomes the value of the first `recipient` if using SMTP</span>
<span class="sd">            or the value `&#39;me&#39;` if using Gmail.</span>
<span class="sd">        subject: The text to include in the subject field.</span>
<span class="sd">        body: The text to include in the body of the email. The text can be enclosed</span>
<span class="sd">            in `&lt;html&gt;&lt;/html&gt;` tags to use HTML elements to format the message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">_prepare_email</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">recipients</span><span class="p">,</span> <span class="n">sender</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">_SMTPConfig</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">email.mime.multipart</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIMEMultipart</span>  <span class="c1"># noqa: PLC0415</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">email.mime.text</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIMEText</span>  <span class="c1"># noqa: PLC0415</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">smtplib</span><span class="w"> </span><span class="kn">import</span> <span class="n">SMTP</span>  <span class="c1"># noqa: PLC0415</span>

        <span class="k">with</span> <span class="n">SMTP</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">port</span><span class="p">)</span> <span class="k">as</span> <span class="n">server</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">starttls</span><span class="p">:</span>
                <span class="n">_</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">ehlo</span><span class="p">()</span>
                <span class="n">_</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">starttls</span><span class="p">()</span>
                <span class="n">_</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">ehlo</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">username</span> <span class="ow">and</span> <span class="n">cfg</span><span class="o">.</span><span class="n">password</span><span class="p">:</span>
                <span class="n">_</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">password</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">MIMEMultipart</span><span class="p">()</span>
            <span class="n">msg</span><span class="p">[</span><span class="s2">&quot;From&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">frm</span>
            <span class="n">msg</span><span class="p">[</span><span class="s2">&quot;To&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">to</span><span class="p">)</span>
            <span class="n">msg</span><span class="p">[</span><span class="s2">&quot;Subject&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject</span> <span class="ow">or</span> <span class="s2">&quot;(no subject)&quot;</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">body</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
            <span class="n">subtype</span> <span class="o">=</span> <span class="s2">&quot;html&quot;</span> <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&lt;html&gt;&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;plain&quot;</span>
            <span class="n">msg</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">MIMEText</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">subtype</span><span class="p">))</span>
            <span class="n">_</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">sendmail</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">frm</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">to</span><span class="p">,</span> <span class="n">msg</span><span class="o">.</span><span class="n">as_string</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">GMail</span><span class="p">(</span><span class="n">account</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">account</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">credentials</span><span class="p">,</span> <span class="n">scopes</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">scopes</span><span class="p">)</span> <span class="k">as</span> <span class="n">gmail</span><span class="p">:</span>
            <span class="n">gmail</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">to</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">frm</span><span class="p">,</span> <span class="n">subject</span><span class="o">=</span><span class="n">subject</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../types/" class="md-footer__link md-footer__link--prev" aria-label="Previous: types">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                types
              </div>
            </div>
          </a>
        
        
          
          <a href="../../readers/" class="md-footer__link md-footer__link--next" aria-label="Next: Readers">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Readers
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2018 - 2025 Measurement Standards Laboratory of New Zealand
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/MSLNZ/msl-loadlib/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/msl-loadlib/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.footer", "navigation.indexes", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "search.highlight", "search.suggest"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>